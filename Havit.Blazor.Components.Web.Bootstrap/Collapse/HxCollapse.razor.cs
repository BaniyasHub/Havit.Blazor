using System;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Components;

namespace Havit.Blazor.Components.Web.Bootstrap
{
	/// <summary>
	/// <see href="https://getbootstrap.com/docs/5.1/components/navbar/">Bootstrap 5 Collapse</see> component.
	/// </summary>
	public partial class HxCollapse
	{
		/// <summary>
		/// Element ID. To be referenced by <see cref="HxCollapseToggleButton.CollapseTarget"/>.
		/// (Autogenerated GUID if not set explicitly.)
		/// </summary>
		[Parameter] public string Id { get; set; }

		/// <summary>
		/// Direction of the animation.
		/// Default is <see cref="CollapseDirection.Vertical"/>.
		/// </summary>
		[Parameter] public CollapseDirection CollapseDirection { get; set; }

		/// <summary>
		/// Additional CSS class.
		/// </summary>
		[Parameter] public string CssClass { get; set; }

		/// <summary>
		/// Content of the navbar.
		/// </summary>
		[Parameter] public RenderFragment ChildContent { get; set; }

		private string defaultId = "hx" + Guid.NewGuid().ToString("N");

		public override async Task SetParametersAsync(ParameterView parameters)
		{
			await base.SetParametersAsync(parameters);

			// to be able to use another default value in ancestors (HxNavbarCollapse)
			this.Id = parameters.GetValueOrDefault(nameof(Id), defaultId);
		}

		protected virtual string GetCssClass()
		{
			return CssClassHelper.Combine(
				"collapse",
				this.CollapseDirection == CollapseDirection.Horizontal ? "collapse-horizontal" : null,
				this.CssClass);
		}
	}
}
